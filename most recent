#include <stdio.h>
#include "E101.h"
#include <unistd.h>
#include <time.h>

//run robot needs fields for
//current quadrant
//camera position

//rubRobot needs to create new
//camera object
//network object
//wheel objects

//main method

class Camera{
        //fields here
        public:
        double runCamera(){

                int countc=0;
                //int main(){
                int i;
                int pix [320];
                init(0);
                int max=0;
                int min=0;
                double midValue;
                double errorRate=0;
                double finalError=0;

                                        while(countc <320)
                                                {pix [countc] = (int)get_pixel(120,countc,3);
                                                        countc++;}


                                        for(i=0;i<320;i++){
                                                if(pix[i]>max){max=pix[i];}
                                                if(pix[i]<min){min=pix[i];}
                                                }

                                for(i=0;i<320;i++){
                                        if(pix[i]>midValue){
                                                pix[i]=0;}
                                        else{pix[i]=1;}
                                        }
                                        for(i=0;i<320;i++){
                                                errorRate=(i-160)*pix[i];
                                                finalError=finalError+errorRate;}
                                                return finalError;
                                                };



};


class GateOpen{
        //fields here
        private:
        char serverAddress[15] = { '1','3','0','.','1','9','5','.','6','.','1','9','6' };       //char server_addr[15] = { '1','2','7','.','0','0','1','.','0','0','1','.','0','0','1' }; TEST THE ADDRESS
        int port = 1024;                                                       //need to find what the port number is0
        char message[24] = { "Please" };                                       //find what the message should b1024

        public:
        //methods here
        int openGate(){
                //connect to the server
                connect_to_server(serverAddress,port);
                //send message to server
                send_to_server(message);
                //get message from server
                receive_from_server(message);
                //send server response back to server
                send_to_server(message);
                //gate opens, mission accomplished

                return 1;

        };

        };




class Wheels{
        Camera a;
        //fields here
        public:
        int speedDiff;
                double errorRate=0;
                double finalError=a.runCamera();
                void setSpeed(){

        //methods here
        speedDiff=(finalError/1000);
        printf("motor %d",speedDiff);
set_motors(1,48+speedDiff);
set_motors(5,48-speedDiff);}
};

class RunRobot{
        //fields here
        public:
        //methods here

        };



int main(){
        //example code
                //make a new objec
                init(0);

                open_screen_stream();


        GateOpen open;
                //call a method on the object
        open.openGate();
        while(true){
                                hardware_exchange();take_picture(); update_screen();}
        //camera on;
        //on.runCamera();
        close_screen_stream();
        return 0;
        };
