
#include <iostream>
#include "E101.h"

using namespace std;
int speedDiff;double errorRate=0;double finalError=0;int countc=0;int main(){int i;int pix [320];init(0);
open_screen_stream();
while(true){
         take_picture(); update_screen(); int countc=0;
while(countc <320)
{pix [countc] = (int)get_pixel(120,countc,3);
 countc++;}

int max=0;
int min=10000000;
for(i=0;i<320;i++){
         if(pix[i]>max){max=pix[i];}}
 for(i=0;i<320;i++){
         if(pix[i]<min){min=pix[i];}
 }
 
 int midValue=(max+min)/2;
 
 for(i=0;i<320;i++){
 if(pix[i]>midValue){
 pix[i]=0;
 }
 else{pix[i]=1;}
 }
 for(i=0;i<320;i++){
 i++
 }
errorRate=0;
finalError=0;
 for(i=0;i<320;i++){
 errorRate=(i-160)*pix[i];
 finalError=finalError+errorRate;
 }
 speedDiff=(finalError/1000);
set_motors(1,48+speedDiff);
set_motors(5,48-speedDiff);
hardware_exchange();
}
close_screen_stream();
return 0;
}




